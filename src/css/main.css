/* ==========================================================================
   1. IMPORTS & DEPENDENCIES
   ========================================================================== */

@import url('https://fonts.googleapis.com/css2?family=Azeret+Mono:ital,wght@0,400;0,500;1,400;1,500&family=DM+Mono:ital,wght@0,400;0,500;1,400;1,500&display=swap')
layer(base);

@import 'tailwindcss';
@plugin '@tailwindcss/typography';

/* ==========================================================================
   2. THEME CONFIGURATION
   ========================================================================== */

@theme {
    /* Font Configuration */
    --font-body: var(--theme-font-body, monospace);
    
    /* Color System */
    --color-bg-primary: var(--theme-dark);
    --color-bg-secondary: var(--theme-on-dark);
    --color-text-primary: var(--theme-on-dark);
    --color-text-secondary: var(--theme-dark);
    
    /* Layout & Spacing */
    --container-8xl: 96rem;
    --spacing-icon: 1em;
    
    /* Typography */
    --font-weight-heading: var(--theme-heading-weight);
    --text-transform-heading: var(--theme-heading-case);
}

/* ==========================================================================
   3. BASE STYLES
   ========================================================================== */

@layer base {
    html {
        @apply antialiased font-body;
    }
    
    body {
        @apply flex flex-col min-h-screen;
    }
    
    body > div {
        @apply flex flex-col grow;
    }

    /* Typography Base */
    h1, h2, h3, h4, h5, h6 {
        @apply break-words;
        line-height: 1.15;
        font-weight: var(--font-weight-heading);
        text-transform: var(--text-transform-heading);
    }

    b, strong {
        @apply font-medium;
    }

    /* Form Elements */
    select {
        @apply bg-no-repeat appearance-none cursor-pointer;
        background-image:
            linear-gradient(45deg, transparent 50%, currentColor 0),
            linear-gradient(135deg, currentColor 50%, transparent 0);
        background-position:
            calc(100% - 18px) calc(1px + 50%),
            calc(100% - 12px) calc(1px + 50%);
        background-size:
            6px 6px,
            6px 6px;
    }
    
    option {
        color: initial;
    }
}

/* ==========================================================================
   4. THEME VARIANTS
   ========================================================================== */

@layer base {
    /* Color Theme System */
    [data-theme='colors-b'] {
        --color-bg-primary: var(--theme-light);
        --color-bg-secondary: var(--theme-on-light);
        --color-text-primary: var(--theme-on-light);
        --color-text-secondary: var(--theme-light);
    }
    
    [data-theme='colors-c'] {
        --color-bg-primary: var(--theme-primary);
        --color-bg-secondary: var(--theme-on-primary);
        --color-text-primary: var(--theme-on-primary);
        --color-text-secondary: var(--theme-primary);
    }
    
    [data-theme='colors-d'] {
        --color-bg-primary: var(--theme-secondary);
        --color-bg-secondary: var(--theme-on-secondary);
        --color-text-primary: var(--theme-on-secondary);
        --color-text-secondary: var(--theme-secondary);
    }
    
    [data-theme='colors-e'] {
        --color-bg-primary: var(--theme-complementary);
        --color-bg-secondary: var(--theme-on-complementary);
        --color-text-primary: var(--theme-on-complementary);
        --color-text-secondary: var(--theme-complementary);
    }
    
    /* Apply theme colors to elements */
    [data-theme^='colors-']:not([data-theme='colors-f']) {
        @apply bg-primary text-primary;
    }

    /* Fix for data wrapper issues from auto annotations */
    form data:has([class*='sm:col-span-2']) {
        @apply sm:col-span-2;
    }
    
    nav data:has([class*='sm:col-start-2']) {
        @apply sm:col-start-2;
    }
    
    li data:has([class*='link-fill']) {
        @apply inline-flex;
    }
}

/* ==========================================================================
   5. COMPONENT STYLES
   ========================================================================== */

@layer components {
    /* Prose Content Styling */
    .prose {
        --tw-prose-body: var(--color-text-primary);
        --tw-prose-headings: var(--color-text-primary);
        --tw-prose-lead: var(--color-text-primary);
        --tw-prose-links: var(--color-text-primary);
        --tw-prose-bold: var(--color-text-primary);
        --tw-prose-counters: var(--color-text-primary);
        --tw-prose-bullets: var(--color-text-primary);
        --tw-prose-hr: var(--color-text-primary);
        --tw-prose-quotes: var(--color-text-primary);
        --tw-prose-quote-borders: var(--color-text-primary);
        --tw-prose-captions: var(--color-text-primary);
        --tw-prose-kbd: var(--color-text-primary);
        --tw-prose-kbd-shadows: from var(--color-text-primary) r g b;
        --tw-prose-code: var(--color-text-primary);
        --tw-prose-pre-code: var(--color-text-secondary);
        --tw-prose-pre-bg: var(--color-bg-secondary);
        --tw-prose-th-borders: var(--color-text-primary);
        --tw-prose-td-borders: var(--color-text-primary);

        a {
            @apply underline font-normal transition-all;

            &:hover {
                @apply no-underline;
            }
        }

        :where(h1, h2, h3, h4, h5, h6) {
            font-weight: var(--font-weight-heading);
            line-height: 1.15;
        }

        blockquote {
            p:first-of-type::before,
            p:last-of-type::after {
                content: none;
            }
        }
    }
}

/* ==========================================================================
   6. UTILITY CLASSES
   ========================================================================== */

@layer utilities {
    /* Shadow Utilities */
    .bottom-shadow-1 { box-shadow: 0 1px 0 0 currentColor; }
    .bottom-shadow-2 { box-shadow: 0 2px 0 0 currentColor; }
    .bottom-shadow-3 { box-shadow: 0 3px 0 0 currentColor; }
    .bottom-shadow-4 { box-shadow: 0 4px 0 0 currentColor; }
    .bottom-shadow-5 { box-shadow: 0 5px 0 0 currentColor; }
    
    /* Link Fill Effect */
    .link-fill {
        @apply transition-all text-primary relative;
        
        &::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--color-bg-secondary);
            z-index: -1;
            transform: scaleY(0);
            transform-origin: bottom;
            transition: transform 0.3s ease;
        }

        &:hover {
            @apply text-secondary;
            
            &::after {
                transform: scaleY(1);
            }
        }
    }
    
    /* Theme Color Utilities */
    .bg-primary { background-color: var(--color-bg-primary); }
    .bg-secondary { background-color: var(--color-bg-secondary); }
    .text-primary { color: var(--color-text-primary); }
    .text-secondary { color: var(--color-text-secondary); }
}
